"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,a){window.voyageDetails={$mapNav:e(".map_nav"),$map:e("#voyage_map"),$iteneraryModule:e(".voyage_details_itinerary_map"),$itineraryDetailsList:e(".voyage_details_itinerary_list"),$itineraryList:e(".view_list"),$itineraryMap:e(".view_map"),$trip_menu_dropdown:e(".trip_menu_dropdown"),$accommodations_rooms:e("#accommodations_rooms"),$table_action_row:e(".table_action_row"),$detailsHero:e(".details_hero"),$heroArrow:e(".hero_arrow"),templates:{selectableInput:'<div class="selectable">\n      <a href="#" class="nav_selectable nav_delete"><span class="visuallyhidden">Decrease room count</span></a>\n        <div class="nav_input">\n          <span class="nav_number">0</span>\n          <span>Room</span>\n        </div>\n        <a href="#" class="nav_selectable nav_add"><span class="visuallyhidden">Increase room count</span></a>\n      </div>',selectButton:'<a href="#" class="a_select">Select</a>'},initVoyageDetails:function(){this.customHandlers()},customHandlers:function(){var a,t=this;e(".rellax").length>0&&(a=new Rellax(".rellax"));var o=e("#voyage_details_onboard");if(o.length){var n=(e('a[href="#overview"]'),e('a[href="#onboard"]'));e("#overview"),e("#onboard");e(document).on("click",".js_onboard_navigation",function(a){a.preventDefault(),n.click();var t=document.getElementById(e(a.currentTarget).data("href")),o=document.getElementById("onboard").getBoundingClientRect().top,i=t.getBoundingClientRect().top,s=document.getElementsByClassName("details_hero")[0].offsetHeight;total_offset=i-o+s+150,setTimeout(function(){e("html, body").animate({scrollTop:total_offset},10,function(){})},600)})}window.mainVariables.$body.on("closeModal",t.closeModal).on("click",".view_list",function(a){a.preventDefault(),e(this).addClass("active"),t.$itineraryMap.removeClass("active"),t.$itineraryDetailsList.fadeIn("slow"),t.$iteneraryModule.hide()}).on("click",".view_map",function(a){a.preventDefault(),e(this).addClass("active"),t.$itineraryList.removeClass("active"),t.$itineraryDetailsList.hide(),t.$iteneraryModule.fadeIn("slow"),window.mainVariables.voyageMapRefresh()}).on("click","#seeFullItinerary",function(a){a.preventDefault(),e(this).hide(),e("#voyage_itinerary tr").fadeIn("slow")}).on("click",".tbody_itinerary tr",function(a){a.preventDefault(),a.stopPropagation(),e(this).find(".link a:not(.hidden)").click()}).on("click",".tbody_itinerary tr .link a",function(e){e.stopPropagation()}).on("click","#printItinerary",function(a){a.preventDefault(),e("body").addClass("jsItineraryPrint"),window.print(),e("body").removeClass("jsItineraryPrint")}),t.$accommodations_rooms.on("click",".td_selected",t.hideSelectable).on("click",".a_select",t.swichSelectable).on("click",".nav_selectable",t.navSelectable).on("click",'input[type="checkbox"]',t.navComparable).on("click",".size_selector a",t.sizeSelector).on("click",".a_tour",t.tour),t.$table_action_row.on("click",'a[data-type="compare"]',t.compare).on("click",'a[data-type="booknow"]',t.bookNow)},objectToQuerystring:function(e){for(var a="?rooms=",t=0;t<e.length;t++)a+=JSON.stringify(e[t]);return a},swichSelectable:function(a,t){a.preventDefault(),a.stopPropagation();var o=e(this).parents("tr"),n=o.find(".td_available");o.hasClass("td_selected")||0===n.length||(o.addClass("td_selected"),1===n.length&&(o.find(".td_select").html(window.voyageDetails.templates.selectableInput),o.find(".td_select").find(".nav_add").focus()))},navSelectable:function(a){a.stopPropagation(),a.preventDefault();var t=e(this),o=t.parents("tr"),n=t.parent().find(".nav_number"),i=Number(n.text());t.hasClass("nav_add")?n.text(i+1):0!==i?n.text(i-1):window.voyageDetails.hideSelectable(o)},hideSelectable:function(a){void 0!==_typeof(a.currentTarget)&&(a=e(a.currentTarget)),a.removeClass("td_selected"),a.find(".td_select").html(window.voyageDetails.templates.selectButton)},bookNow:function(a){a.preventDefault();var t=window.voyageDetails.filterBooks();if(t.length<1)return void console.log("Rooms not selected yet");var o=e.ajax({url:"./",type:"post",dataType:"json",data:t});o.fail(function(e){console.log(e.responseText)}),o.done(function(e){console.log(e.responseText)})},filterBooks:function(){var a=[];return this.$accommodations_rooms.find("tr[data-room-id]").map(function(t,o,n){var i=Number(e(o).find(".nav_number").text());if(0!==i)return a.push({roomId:o.dataset.roomId,roomCuantity:i})}),a},comparable:[],navComparable:function(a){a.stopPropagation();var t=e(this),o=t.parents("tr");t.hasClass("checked")?(t.removeClass("checked"),window.voyageDetails.comparable=window.voyageDetails.comparable.filter(function(e,a,t){return e!==Number(o.attr("data-room-id"))})):(t.addClass("checked"),window.voyageDetails.comparable.push(Number(o.attr("data-room-id"))))},compare:function(e){e.preventDefault();var a=window.voyageDetails;if(console.log(a.comparable),0===a.comparable.length||1===a.comparable.length)return void console.log("Select two at least.");if(a.comparable.length>3)return void console.log("Select only three please.");window.mainVariables.$body.addClass("modal-ajax-open loadingModal");var t=window.mainVariables.$body.find(".modal-inner-viewport .content"),o="?roomsID="+a.comparable.toString(),n="/pages/compare-accommodations.html"+o,i=document.createElement("iframe");i.setAttribute("name","modal"),i.setAttribute("id","modal"),i.setAttribute("src",n),t.empty().append(i),setTimeout(function(){window.mainVariables.$body.removeClass("loadingModal").addClass("successModalLoad")},600)},closeModal:function(){this.$body.removeClass("modal-ajax-open loadingModal")}.bind(window.mainVariables),tour:function(e){e.preventDefault(),e.stopPropagation()},sizeSelector:function(a){a.preventDefault(),a.stopPropagation();var t=e(this),o=window.voyageDetails.$accommodations_rooms.find(".td_size");t.addClass("clicked").siblings("a").removeClass("clicked"),t.hasClass("sf")?(o.find(".sf").removeClass("hide").addClass("show"),o.find(".meter").addClass("hide").removeClass("show")):(o.find(".meter").removeClass("hide").addClass("show"),o.find(".sf").addClass("hide").removeClass("show"))}},e(".jsVoyageDetails").length>0&&(FeatureCarousel.initSlickFn(),Excursions.initExcursions(),voyageMapDetails.initVoyageMapDetails(),voyageDetails.initVoyageDetails())}(jQuery,window.talonUtil);