"use strict";$(document).ready(function(){$(".jsSearchInput").keypress(function(e){if(console.log(e.which),13===e.which){var o=encodeURI($("#searchResults").val());return window.location.href="/search-results?indexCatalogue=site-search&wordsMode=AllWords&searchQuery="+o,!1}})}),window.openAskCrystalForm=function(){window.formsFn.showModal($(".ask-crystal").data("modal"))},function(e,o){window.onload=function(){for(var e=0;e<document.getElementsByClassName("jsForms").length;e++)document.querySelectorAll('input[type="text"]:enabled')[e].value=""},window.formsFn={$forms:e(".jsForms"),$btnsubmit:e(".jsFormsSubmit"),initForms:function(){this.labelFormFocus(),this.showPassword(),this.validateFormOnSubmit(),this.customSelect(),this.toggleCheckboxAction(),this.showSubscribeForm(),this.actionCleanInputSearch(),this.showSearchSuggestions(),this.setLeadSource()},resetForm:function(){e(".jsForms").length>0&&e(".jsForms :input").val("")},labelFormFocus:function(){this.$forms.find('input[type="text"]').map(function(o,t){""!==t.value&&e(t).parents(".regular-input").addClass("focus-input-label")}),this.$forms.on("keyup",'input[type="password"]',function(){e(this).parent().find(".show-hide-password").show(),""===e(this).val()&&e(this).parent().find(".show-hide-password").hide()}),this.$forms.on("keyup",'.regular-search-cancel input[type="text"]',function(){e(this).parent().addClass("keyup-input"),""===e(this).val()&&e(this).parent().removeClass("keyup-input")}),setTimeout(function(){e('input[type="text"]:-webkit-autofill').closest(".regular-input").addClass("focus-input-label"),e('input[type="password"]:-webkit-autofill').closest(".regular-input").addClass("focus-input-label")},1e3),e("body").on("keyup",'input[type="checkbox"]',function(){e(this).closest("label").addClass("focus-checkbox")}).on("keydown",'input[type="checkbox"]',function(){e(this).closest("label").removeClass("focus-checkbox")}),this.$forms.on("focusin",".regular-input",function(){e(this).addClass("focus-input-label")}).on("focusout",".regular-input",function(){e(this).find("input").val()||e(this).removeClass("focus-input-label")})},showPassword:function(){this.$forms.on("click",".show-hide-password",function(o){o.preventDefault(),o.stopPropagation();var t=e(this),s=t.prevAll("input");"password"===s.attr("type")?(t.text("HIDE"),t.prevAll("input").attr("type","text")):(t.text("SHOW"),t.prevAll("input").attr("type","password"))})},validateFormOnFocus:function(){this.$forms.on("focusout",".required",function(){var o=e(this);""===o.val()?o.parent().addClass("error"):o.parent().removeClass("error")})},validateFormOnSubmit:function(){var o=this;this.$forms.on("submit",function(t){console.log(e(this));var s=e(this).attr("id"),a=e(this).closest("form").attr("identifier"),r=e("#"+s+" .required"),n=e("#"+s+" input:checkbox.required"),l=e("#"+s+" .email"),c=e("#"+s+" .password"),i=e("#"+s+" .community-password"),u=e("#"+s+" .repassword"),d=e("#"+s+" .number"),h=e("#"+s+" .phonenumber"),p=e("#"+s+" .first-name"),m=e("#"+s+" .last-name"),f=!1;return console.log("first"+f),e("#"+s+" .error").removeClass("error"),e("#"+s+" .error-password").removeClass("error-password"),e("#"+s+" .error-email").removeClass("error-email"),r.length&&(r.each(function(o,t){""===e(t).val()&&(e(t).parent().addClass("error"),f=!0)}),console.log("required"+f)),n.length&&(n.is(":checked")||(e(n).parent().addClass("error"),f=!0,console.log(f))),l.length&&(o.validateEmail(l.val())||(l.parent().addClass("error error-email"),f=!0),console.log("email"+f)),c.length&&(o.validatePassword(c.val())||(c.parent().addClass("error error-password"),f=!0),console.log("password"+f)),i.length&&(o.validateCommunityPassword(i.val())||(i.parent().addClass("error error-password"),f=!0),console.log("password"+f)),u.length&&(o.validateRePassword(c.val(),u.val())||(u.parent().addClass("error error-password"),f=!0),console.log("repassword"+f)),d.length&&(d.each(function(t,s){e(s).val()&&(console.log("if number val"),o.validateIsNumber(e(s).val())||(e(s).parent().addClass("error"),f=!0))}),console.log("number"+f)),h.length&&(h.each(function(t,s){e(s).val()&&(o.validateIsPhoneNumber(e(s).val())||(e(s).parent().addClass("error"),f=!0))}),console.log("phone"+f)),p.length&&(p.each(function(o,t){e(t).val().length>40&&(e(t).parent().addClass("error"),f=!0)}),console.log("First name exceeds 40 characters")),m.length&&(m.each(function(o,t){e(t).val().length>80&&(e(t).parent().addClass("error"),f=!0)}),console.log("Last name exceeds 80 characters")),console.log("total"+f),!f&&(console.log(f),console.log("form has been sent"),"loginForm"===a&&alert("Email:        "+l.val()+"\nPassword: "+c.val()),!0)})},validateEmail:function(e){var o=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return o.test(String(e).toLowerCase())},validatePassword:function(e){var o=/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{8,}$/;return o.test(e)},validateCommunityPassword:function(e){var o=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;return o.test(e)},validateRePassword:function(e,o){if(e===o)return!0},validateIsNumber:function(e){var o=/^(\d+-?)+\d+$/;return o.test(e)},validateIsPhoneNumber:function(e){var o=/\(?([0-9]{3})\)?([ .-]?)([0-9]{3})\2([0-9]{4})/;return o.test(e)},customSelect:function(){var o=e("#site-main").attr("class");e('[data-id="main_flag"]').hasClass("jsVoyageFinder")&&(o="jsVoyageFinder"),e(".regular-select select").select2({theme:"custom-option-select custom-option-select-"+o,width:"100%"})},toggleCheckbox:function(o){e('.toggle-checkbox input[type="checkbox"]').prop("checked",!1),o.prop("checked",!0),o.is(":checked")&&o.hasClass("checked")?(o.prop("checked",!1),o.removeClass("checked")):(o.prop("checked",!0),e('.toggle-checkbox input[type="checkbox"]').removeClass("checked"),o.addClass("checked"))},toggleCheckboxAction:function(){var o=this;this.$forms.on("change",'.toggle-checkbox input[type="checkbox"]',function(t){t.preventDefault(),t.stopPropagation(),o.toggleCheckbox(e(this))}).on("keypress",'input[type="checkbox"]',function(t){t.preventDefault(),t.stopPropagation(),13===(t.keyCode?t.keyCode:t.which)&&o.toggleCheckbox(e(this))})},showSubscribeForm:function(){var o=this;e(".jsSubscribe").click(function(t){t.preventDefault(),t.stopPropagation(),o.showModal(e(".subscribeForm").data("modal"))})},showModal:function(o){e('[data-modal="'+o+'"].customModal.out').removeClass("out"),e('[data-modal="'+o+'"].customModal').addClass("showcustomModal"),e("body").addClass("openModal"),e('[data-modal="'+o+'"].customModal .form-group-content:first-child').find("input").first().focus(),e(".closeModal").click(function(t){t.preventDefault(),t.stopPropagation(),e('[data-modal="'+o+'"].customModal.showcustomModal').removeClass("showcustomModal"),e('[data-modal="'+o+'"].customModal').addClass("out"),e("body").removeClass("openModal")})},cleanInputSearch:function(){e(".header_search").find("input").val(""),e(".header_search").find(".regular-header-search").removeClass("keyup-input"),e(".header_search").find(".regular-header-search.focus-input-label").removeClass("focus-input-label")},actionCleanInputSearch:function(){var o=this;e(".regular-search-cancel").on("click",".cancel",function(t){t.preventDefault(),t.stopPropagation(),o.cleanInputSearch(),e(".header_search").find("input").focus()}),e(".search_close").on("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("assa"),o.cleanInputSearch()}),e(".toggle-menu").on("click",function(e){e.preventDefault(),e.stopPropagation(),o.cleanInputSearch()}),e(".regular-search.regular-search-cancel").on("click",".cancel",function(o){o.preventDefault(),o.stopPropagation(),e(this).parent().find("input").val("")}),e(".link_search").on("click",function(o){o.preventDefault(),o.stopPropagation(),e(".header_search").find("input").focus()})},setLeadSource:function(){e("jsSalesForceForm").length>0&&"en-GB"===e("html").attr("lang")&&(e(".requestForm #lead_source").val("RAQ UK"),e(".subscribeForm #lead_source").val("Email Signup UK"),e(".requestForm #retURL").val("http://www.crystalcruises.co.uk/RAQSuccess"),e(".subscribeForm #retURL").val("http://www.crystalcruises.co.uk/EmailSuccess"))},showSearchSuggestions:function(){}},formsFn.initForms()}(jQuery,window.talonUtil);