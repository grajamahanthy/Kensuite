"use strict";function checkMediaHero(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",t=document.querySelectorAll(e+" .js_bg_media"),o=(window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth)<767,a=0;a<t.length;a++){var n=t[a].getAttribute("data-desktop_video"),s=""!==t[a].getAttribute("data-mobile_video")?t[a].getAttribute("data-mobile_video"):n,r=t[a].getAttribute("data-desktop_banner"),i=""!==t[a].getAttribute("data-mobile_banner")?t[a].getAttribute("data-mobile_banner"):r,l=t[a].querySelectorAll("img"),d=t[a].querySelectorAll("video"),c=t[a].querySelectorAll("source"),h=o?s:n,u=o?i:r;t[a].style.backgroundImage="url("+u+")",c.length&&h?(c[0].setAttribute("src",h),d[0].load(),d[0].play(),t[a].style.backgroundImage="none"):c.length&&(c[0].parentNode.removeChild(c[0]),d[0].parentNode.removeChild(d[0])),l.length&&u&&l[0].setAttribute("src",u)}}$(window).on("reinitialize",function(){checkMediaHero()}),function(e,t){function o(e){var t=864e5,o=Date.now()-t;return parseInt(e)>o}function a(){var t=document.getElementById("aunz_id");if(t){if(window.localStorage.getItem("nzAuPopupShownDate")&&o(window.localStorage.getItem("nzAuPopupShownDate")))return!0;window.localStorage.setItem("nzAuPopupShownDate",Date.now()),e(".aunzModal").fadeIn("slow"),t.parentNode.classList.add("hidden")}}function n(){var t=e(".rooms .js_room_compare"),o=0,a="Compare <small>Up to 3</small>",n=e(".js_room_compare_button");t.on("click",function(s){var r="/"+e(s.currentTarget).data("room-id");if(e(s.currentTarget).is(":checked")){if(o++,o>3)return e(s.currentTarget).attr("checked",!1),o--,!1;n.attr("data-url",n.attr("data-url")+r)}else o--,n.attr("data-url",n.attr("data-url").replace(r,""));switch(o){case 0:a="Compare <small>Up to 3</small>";break;case 1:a="Compare <small>1 of 3</small> Selected";break;case 2:a="Compare <small>2 of 3</small> Selected";break;case 3:a="Compare <small>3 of 3</small> Selected"}n.html(a),t.toggleClass("faded_out",3===o),n.toggleClass("disabled_link",o>3||o<2)})}function s(){var t=e(".js_vg_link"),o=e(".vg_popup"),a=e(".vg_backdrop"),n=e(".card_inner",e(".vg_section")),s=e("iframe",o).first(),r=e(".vg_section");t.on("click",function(o){t.removeClass("active"),e(o.currentTarget).addClass("active")}),n.on("click",function(t){t.preventDefault();var o=e(t.currentTarget).data("video");o.indexOf("youtu.be/")>-1&&(o=o.slice(o.indexOf("youtu.be/")+9));var n="https://www.youtube.com/embed/"+o+"?rel=0&amp;showinfo=0";s.attr("src",n),a.addClass("shown"),a.fadeToggle(400)}),a.on("click",function(e){a.removeClass("shown"),a.fadeToggle(400),s.attr("src","")}),r.each(function(t,o){var a=e(o),n=e(".card",a),s=(e(".card_inner",a),1),r=Math.ceil(n.length/4),i=e(".js_show_less_cards",a),l=e(".js_show_more_cards",a);n.length<5?l.hide():n.slice(4).hide(),l.on("click",function(e){e.preventDefault(),n.show(),s++,n.slice(4*s).hide(),i.toggle(s>1),l.toggle(s!==r)}),i.on("click",function(e){e.preventDefault(),n.show(),s--,n.slice(4*s).hide(),i.toggle(s>1),l.toggle(s!==r)})})}function r(){var e=document.getElementsByClassName("js_fill");window.mainVariables.getVoyages().then(function(t){for(var o=0,a=t.VoyageCollection,n=function(t){var n=e[t],s=n.dataset.fillrule;switch(n.dataset.jsfill){case"total_voyages_await":o="999"!==n.textContent?n.textContent:a.length;break;case"experience":o=a.filter(function(e){var t=e.Type.toLowerCase().indexOf("yacht")>-1?"yacht":e.Type.toLowerCase();return s.toLowerCase().indexOf(t)>-1}).length;break;case"ship":o=a.filter(function(e){return s.toLowerCase().indexOf(e.ShipName.toLowerCase())>-1}).length;break;case"destination":o=a.filter(function(e){return e.RegionCodes.indexOf(s)>-1}).length}n.textContent=o},s=0;s<e.length;s++)n(s)}).then(function(){window.NumberCounters.init()})}function i(){var e=window.location.pathname,t=document.querySelectorAll(".header_nav a");if(e.length>1)for(var o=0;o<t.length;o++){if(e.indexOf(t[o].getAttribute("href"))>-1)return void t[o].parentElement.classList.add("active");if(e.indexOf("/voyage/")>-1&&t[o].getAttribute("href").indexOf("voyage-finder")>-1)return void t[o].parentElement.classList.add("active")}}function l(){var t=e("#ask-wrap"),o=e(".ask_popup"),a=e(".js_open_popup",t),n=e(".js_close_popup",t),s=e(".ask_chat"),r=e("#jsBackToTop"),i=e(".js_open_chat"),l=e(".js_close_chat"),d=e("#site-header"),c=e("#dark_footer"),h=e("#site-footer");a.on("click",function(e){e.preventDefault(),o.addClass("shown"),t.addClass("popup_shown"),c.addClass("show_askpopup"),d.addClass("show_askpopup"),h.addClass("show_askpopup")}),n.on("click",function(e){e.preventDefault(),o.removeClass("shown"),t.removeClass("popup_shown"),c.removeClass("show_askpopup"),d.removeClass("show_askpopup"),h.removeClass("show_askpopup")}),i.on("click",function(e){e.preventDefault(),s.addClass("shown"),a.addClass("hidden"),r.addClass("hidden")}),l.on("click",function(e){e.preventDefault(),s.removeClass("shown"),a.removeClass("hidden"),r.removeClass("hidden")})}function d(){var t=e(".link_profile"),o=e(".link_wishlist");t.toggleClass("active",null!==c("contactId")),o.toggleClass("active",parseInt(c("wishlist"))>0)}function c(e){for(var t=e+"=",o=document.cookie.split(";"),a=0;a<o.length;a++){for(var n=o[a];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return null}function h(){var t=e("#extra_nav"),o=e(".left_nav").html();t.html(o)}function u(){(e("html").attr("lang").indexOf("gb")>-1||e("html").attr("lang").indexOf("GB")>-1)&&e(".size_selector a.meter").click()}if(e(".js_heroslider").length>0&&(e(".js_heroslider").slick({fade:!0,speed:1e3,autoplay:!0,autoplaySpeed:5001}),e(".jsHeroArrow").length>0&&window.mainVariables.clickScrollTo(".jsHeroArrow",e("#scrollTo").offset().top,2e3)),e(".js_promo_slider").length>0){var p=e(".paging_info"),f=e(".js_promo_slides");f.on("init reInit afterChange",function(e,t,o,a){var n=(o?o:0)+1;p.text(n+" / "+t.slideCount)}),f.slick({asNavFor:".js_promo_slider_bgs",dots:!0,appendDots:e(".slide_control"),dotsClass:"diamonds",arrows:!0,appendArrows:e(".slide_control")}),e(".js_promo_slider_bgs").slick({arrows:!1,fade:!0,asNavFor:".home_voyage_slides",draggable:!1})}if(e(".js_feature_slider").length>0&&FeatureCarousel.initSlickFn(),e(".js_destination_finder").length>0){Globe.initGlobe();var _=e("body"),g=!1;e("#explore").hide(),e("#surprise").show(),_.on("click",".faux_dropdown",function(t){t.preventDefault(),e(".home_destination_finder").hasClass("dests_shown")?(e(".home_destination_finder").removeClass("dests_shown"),e(this).find("i").addClass("icon-arrow-down"),e(this).find("i").removeClass("icon-arrow-up"),e(".faux_dropdown_text").text("Where do you want to go?"),e(".dest_nav a").attr("tabindex",-1),e(".dest_nav li.active").removeClass("active"),e("#explore").hide(),e("#surprise").show()):(e(this).find("i").removeClass("icon-arrow-down"),e(this).find("i").addClass("icon-arrow-up"),e(".home_destination_finder").addClass("dests_shown"),e(".faux_dropdown_text").text("Where do you want to go?"),e(".dest_nav a").attr("tabindex",0),e(".dest_home li.active").removeClass("active"),e("#surprise").hide(),e("#explore").hide())}).on("click",".dest_home a",function(t){t.preventDefault(),e(".faux_dropdown_text").text(e(this).text()),e(".dest_intro_home").addClass("active"),g?g=!1:e(".home_destination_finder").addClass("dests_shown"),e("a#explore").attr("href",e(this).closest("li").find(".text_blurb a").attr("href")),e("a#explore").show(),e("a#surprise").hide(),window.innerWidth<768&&(e(".home_destination_finder").removeClass("dests_shown"),setTimeout(function(){e("html, body").animate({scrollTop:e(".section_header").offset().top-100},500)}),e(".faux_dropdown i").addClass("icon-arrow-down"),e(".faux_dropdown i").removeClass("icon-arrow-up"),e(".text_blurb_wrap").addClass("active"))}),e(".home_destination_finder a#surprise").on("click",function(e){g=!0})}if(e(".container.ships").length>0){e(".container.ships").slick({arrows:!1,mobileFirst:!0,centerMode:!0,centerPadding:"9.375%",responsive:[{breakpoint:768,settings:{centerMode:!1,slidesToShow:3,draggable:!1}}]});var m=e(window).height(),w=e(".site_header").height(),v=m-w+6;e(".home_hero .slide").css("height",v),e(".home_hero").css("height",v),e(".home_hero_wrap").css("height",v),e(window).resize(function(){m=e(window).height(),w=e(".site_header").height(),v=m-w+6,e(".home_hero .slide").css("height",v),e(".home_hero").css("height",v),e(".home_hero_wrap").css("height",v),e(".container.ships")[0].slick.refresh()});var C=new ScrollMagic.Controller;new ScrollMagic.Scene({triggerElement:".ships_container"}).setClassToggle(".ships_wrap","active").addTo(C)}e("body").on("click",".print_screen",function(t){t.preventDefault(),e("body").addClass("print_frame");var o=e(e(t.currentTarget).data("elementframe"));o.addClass("to_print"),window.print(),e("body").removeClass("print_frame"),o.removeClass("to_print")}),e("body").on("click",".js_close_modal",function(t){t.preventDefault(),e(t.currentTarget).closest(".js_modal").fadeOut("fast")}),i(),checkMediaHero(),r(),s(),l(),n(),d(),h(),u(),setTimeout(function(){a()},5e3)}(jQuery,window.talonUtil);