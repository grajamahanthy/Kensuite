"use strict";!function(e,a){window.FilteredVoyages={init:function(){var e=window.FilteredVoyages;mainVariables.getVoyages().then(function(a){e.prepFilteredVoyages(a)})},prepFilteredVoyages:function(a){for(var r=window.FilteredVoyages,t={templateId:"template-voyage-item",resultsWrapper:document.getElementById("tiles")},o=r.templateGenerator(t.templateId),i=a.VoyageCollection,l=[],n=e(".jsFilterBy").attr("data-filter-field"),p=e(".jsFilterBy").attr("data-filter-value"),g=0,c=i.length;g<c&&l.length<6;g++)i[g][n].indexOf(p)>-1&&l.push(i[g]);t.resultsWrapper.innerHTML=r.generateHTML(o,l),window.mainVariables.bLazy.revalidate(),window.wishList.addClickHandlers()},templateGenerator:function(e){return document.getElementById(e).innerHTML},generateHTML:function(e,a){var r="";return a.map(function(a,t){var o=e;o=o.replace(/%%index%%/g,200*t),o=o.replace(/%%VoyageId%%/g,a.VoyageId),o=o.replace(/%%Name%%/g,a.ShipName),o=o.replace(/%%Duration%%/g,a.Duration),o=o.replace(/%%fareTooltip%%/g,a.FaresFromTooltip);var i="showPrice";0!==a.FaresFromGb&&0!==a.FaresFromUs||(i="hidePrice"),o=o.replace(/%%callForAvailability%%/g,i),o=o.replace(/%%fareFromGb%%/g,"£"+a.FaresFromGb.formatMoney(0,".",",")),o=o.replace(/%%fareFromUs%%/g,"$"+a.FaresFromUs.formatMoney(0,".",",")),o=o.replace(/%%urlName%%/g,a.UrlName),o=o.replace(/%%backgroundImage%%/g,a.Image);var l=a.EmbarkText.replace("/"," / ");l=l.split(" to "),l.length>1?(o=o.replace(/%%fromLocation%%/g,l[0]+" to "),o=o.replace(/%%toLocation%%/g,l[1])):(o=o.replace(/%%fromLocation%%/g,l[0]),o=o.replace(/%%toLocation%%/g,""));var n="";a.Ports.map(function(e,r){n+=e.placeName+", "+e.country,r!==a.Ports.length-1&&(n+='<i class="sep">…</i>')}),o=o.replace(/%%description%%/g,n);var p=new Date(a.BeginDate);p=p.toUTCString(),p=p.split(" "),o=o.replace(/%%departureDay%%/g,p[1]),o=o.replace(/%%departureMonth%%/g,p[2]),o=o.replace(/%%departureYear%%/g,p[3]),r+=o}),r}},e(".jsFilteredVoyages").length>0&&window.FilteredVoyages.init()}(jQuery,window.talonUtil);